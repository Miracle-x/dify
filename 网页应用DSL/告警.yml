app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: å‘Šè­¦
  use_icon_as_answer_icon: false
kind: app
version: 0.1.1
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
    opening_statement: ''
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: start
        targetType: template-transform
      id: 1720708196729-source-1721231004955-target
      selected: false
      source: '1720708196729'
      sourceHandle: source
      target: '1721231004955'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: template-transform
        targetType: llm
      id: 1721231004955-source-1721656895073-target
      source: '1721231004955'
      sourceHandle: source
      target: '1721656895073'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: template-transform
      id: 1721656895073-source-1721275010214-target
      source: '1721656895073'
      sourceHandle: source
      target: '1721275010214'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: template-transform
        targetType: llm
      id: 1721275010214-source-1721047696945-target
      source: '1721275010214'
      sourceHandle: source
      target: '1721047696945'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: 1721047696945-source-1721659385758-target
      source: '1721047696945'
      sourceHandle: source
      target: '1721659385758'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: http-request
      id: 1721659385758-source-1721232197774-target
      source: '1721659385758'
      sourceHandle: source
      target: '1721232197774'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: http-request
        targetType: code
      id: 1721232197774-source-17217051422320-target
      source: '1721232197774'
      sourceHandle: source
      target: '17217051422320'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: end
      id: 17217051422320-source-1721232211869-target
      source: '17217051422320'
      sourceHandle: source
      target: '1721232211869'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: å†œä½œç‰©åç§°
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: plant_name
        - label: è®¾å¤‡æ•°æ®
          max_length: 33024
          options: []
          required: true
          type: paragraph
          variable: decives_data
        - label: å†œä½œç‰©ç”Ÿé•¿æ—¶æœŸï¼ˆå‘èŠ½ç­‰ï¼‰
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: plant_period
      height: 142
      id: '1720708196729'
      position:
        x: 1647.5697720131282
        y: -142.75364472225868
      positionAbsolute:
        x: 1647.5697720131282
        y: -142.75364472225868
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: "è¯·åˆ†æ{{#1720708196729.plant_name#}}çš„ç§æ¤æ¡ä»¶æ˜¯å¦åˆé€‚ä»¥åŠå¦‚ä½•è°ƒæ•´ã€‚æ¡ä»¶å¦‚ä¸‹ï¼š\n\næ”¶åˆ°çš„è®¾å¤‡æ•°æ®ä¸ºï¼š\n\
          {{#1720708196729.decives_data#}}\n\né€‚å®œ{{#1720708196729.plant_name#}}çš„ç”Ÿé•¿æ¡ä»¶æ˜¯ï¼š\n\
          {{#1721656895073.text#}}\n\nä½ å¯ä»¥è¿›è¡Œçš„æŒ‡ä»¤æ“ä½œå¦‚ä¸‹ï¼š\n{{#1721275010214.output#}}\n\n\
          è¯·æ ¹æ®ä¸Šè¿°æƒ…å†µè¿›è¡Œé€æ­¥ç»¼åˆåˆ†æï¼ˆéœ€è¦åˆ†æ...ï¼‰ï¼Œå†³å®šæ˜¯å¦éœ€è¦é‡‡å–æªæ–½å¹²é¢„å®ƒçš„ç”Ÿé•¿ç¯å¢ƒï¼Œè¯´æ˜åŸå› ã€‚æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼å›ç­”ã€‚ä¸è¦å›ç­”é™¤JSONä»¥å¤–çš„ä»»ä½•ä¸œè¥¿ã€‚\n\
          {\n  //å¯¹å·²çŸ¥ä¿¡æ¯çš„ç»¼åˆè¯´æ˜ï¼Œè¦æ±‚çœŸå®å¯é \n  known_info: string,\n  //æ˜¯å¦éœ€è¦å¹²é¢„\n  need_action:\
          \ True or False,\n  //å¦‚æœä¸éœ€è¦å¹²é¢„ï¼Œåˆ™actioné‡Œçš„å€¼éƒ½è®¾ä¸ºç©ºå­—ç¬¦ä¸²\n  action:{\n    //å¼‚å¸¸æƒ…å†µæè¿°\n\
          \    abnormal_desc: string,\n    //å…·ä½“åº”å¯¹æªæ–½\n    value: string,\n    //è§£é‡Š\n\
          \    reason: string\n  },\n  //æ€»ç»“ä¿¡æ¯ï¼ˆåŒ…æ‹¬è®¾å¤‡æ•°æ®ã€ä½œç‰©é€‚å®œæ¡ä»¶ã€æªæ–½ã€ç»“æœé¢„æµ‹ç­‰ï¼‰ï¼Œè¦æ±‚è¯­è¨€ç²¾ç®€ï¼Œä¿¡æ¯å®Œæ•´ã€‚\n\
          \  analyse: string,  \n}"
        model:
          completion_params:
            temperature: 0
          mode: chat
          name: gpt-4o
          provider: openai
        prompt_template:
        - edition_type: basic
          id: 28c6b80a-2758-4a61-b908-f3869e8fcaff
          role: system
          text: æ‚¨æ˜¯ä¸€ä½å…·æœ‰ä¸°å¯Œå†œä¸šçŸ¥è¯†å’Œå®è·µç»éªŒçš„å†œä¸šä¸“å®¶ã€‚
        - id: 835cbe88-849f-4444-af07-af4ecdfcbd9b
          role: user
          text: "è¯·åˆ†æ{{#1720708196729.plant_name#}}çš„ç§æ¤æ¡ä»¶æ˜¯å¦åˆé€‚ä»¥åŠå¦‚ä½•è°ƒæ•´ã€‚æ¡ä»¶å¦‚ä¸‹ï¼š\n\næ”¶åˆ°çš„è®¾å¤‡æ•°æ®ä¸ºï¼š\n\
            {{#1720708196729.decives_data#}}\n\né€‚å®œ{{#1720708196729.plant_name#}}çš„ç”Ÿé•¿æ¡ä»¶æ˜¯ï¼š\n\
            {{#1721656895073.text#}}\n\nä½ å¯ä»¥è¿›è¡Œçš„æŒ‡ä»¤æ“ä½œå¦‚ä¸‹ï¼š\n{{#1721275010214.output#}}\n\
            \nè¯·æ ¹æ®ä¸Šè¿°æƒ…å†µè¿›è¡Œé€æ­¥ç»¼åˆåˆ†æï¼ˆéœ€è¦åˆ†æ...ï¼‰ï¼Œå†³å®šæ˜¯å¦éœ€è¦é‡‡å–æªæ–½å¹²é¢„å®ƒçš„ç”Ÿé•¿ç¯å¢ƒï¼Œè¯´æ˜åŸå› ã€‚æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼å›ç­”ã€‚ä¸è¦å›ç­”é™¤JSONä»¥å¤–çš„ä»»ä½•ä¸œè¥¿ã€‚\n\
            {\n  //å¯¹å·²çŸ¥ä¿¡æ¯çš„ç»¼åˆè¯´æ˜ï¼Œè¦æ±‚çœŸå®å¯é \n  known_info: string,\n  //æ˜¯å¦éœ€è¦å¹²é¢„\n  need_action:\
            \ True or False,\n  //å¦‚æœä¸éœ€è¦å¹²é¢„ï¼Œåˆ™actioné‡Œçš„å€¼éƒ½è®¾ä¸ºç©ºå­—ç¬¦ä¸²\n  action:{\n    //å¼‚å¸¸æƒ…å†µæè¿°\n\
            \    abnormal_desc: string,\n    //å…·ä½“åº”å¯¹æªæ–½\n    value: string,\n    //è§£é‡Š\n\
            \    reason: string\n  },\n  //æ€»ç»“ä¿¡æ¯ï¼ˆåŒ…æ‹¬è®¾å¤‡æ•°æ®ã€ä½œç‰©é€‚å®œæ¡ä»¶ã€æªæ–½ã€ç»“æœé¢„æµ‹ç­‰ï¼‰ï¼Œè¦æ±‚è¯­è¨€ç²¾ç®€ï¼Œä¿¡æ¯å®Œæ•´ã€‚\n\
            \  analyse: string,  \n}"
        selected: false
        title: åˆ†ææ•°å€¼ã€é‡‡å–æªæ–½ï¼ˆä¸­æ–‡ï¼‰
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: false
      height: 782
      id: '1721047696945'
      position:
        x: 2266.892190129982
        y: -142.75364472225868
      positionAbsolute:
        x: 2266.892190129982
        y: -142.75364472225868
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        selected: false
        template: é€‚å®œ{{ plant_period }}æœŸ{{ plant_name }}ç”Ÿé•¿çš„æ¸©åº¦ã€ç©ºæ°”æ¹¿åº¦ã€åœŸå£¤PHå€¼ã€åœŸå£¤ç”µå¯¼ç‡ã€æ°®é’¾ç£·å«é‡çš„èŒƒå›´åˆ†åˆ«æ˜¯å¤šå°‘
        title: æŸ¥è¯¢é€‚å®œæ¡ä»¶
        type: template-transform
        variables:
        - value_selector:
          - '1720708196729'
          - plant_name
          variable: plant_name
        - value_selector:
          - '1720708196729'
          - plant_period
          variable: plant_period
      height: 54
      id: '1721231004955'
      position:
        x: 1647.5697720131282
        y: 121.94656623087278
      positionAbsolute:
        x: 1647.5697720131282
        y: 121.94656623087278
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config:
            api_key: jTWquHn4r7pEOrTKCyzjBhYZ
            type: bearer
          type: no-auth
        body:
          data: "{\n\t\"query\": \"è¯·ç‰¢è®°ä»¥ä¸‹å†…å®¹ï¼š\\n{{#1721659385758.analyse#}}\",\n\t\"\
            inputs\": {\n\t\t\"rag_mode\": \"mix\"\n\t},\n\t\"user\": \"warn_api\"\
            ,\n\t\"conversation_id\": \"\",\n\t\"tag\": \"warning\",\n\t\"response_mode\"\
            : \"blocking\"\n}"
          type: json
        desc: ''
        headers: 'Content-Type:application/json

          Authorization:Bearer app-KfYfnZTQKJZIhFtaZn53L907'
        method: post
        params: ''
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: å¼€å¯å‘Šè­¦ä¼šè¯
        type: http-request
        url: http://agrox.horai.cn:19080/v1/chat-messages
        variables: []
      height: 106
      id: '1721232197774'
      position:
        x: 2652.59989980016
        y: 3.113818080229109
      positionAbsolute:
        x: 2652.59989980016
        y: 3.113818080229109
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1721659385758'
          - analyse
          variable: analyse
        - value_selector:
          - '1721659385758'
          - normal
          variable: normal
        - value_selector:
          - '1721659385758'
          - action
          variable: action
        - value_selector:
          - '17217051422320'
          - conversation
          variable: body
        - value_selector:
          - '1721659385758'
          - known_info
          variable: known_info
        selected: false
        title: ç»“æŸ
        type: end
      height: 194
      id: '1721232211869'
      position:
        x: 2652.59989980016
        y: 278.87208992708474
      positionAbsolute:
        x: 2652.59989980016
        y: 278.87208992708474
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        selected: false
        template: "æŒ‡ä»¤æ ¼å¼\r\nçŒæº‰ï¼š{çŒæº‰æ—¶é•¿}ï¼Œæ‰“è¯ï¼š{å†œè¯ç§ç±»} - {æµ“åº¦}ï¼Œæ–½è‚¥ï¼š{è‚¥æ–™ç§ç±»} - {ç”¨é‡}\r\n\r\nç¤ºä¾‹\r\
          \nçŒæº‰ï¼š30åˆ†é’Ÿï¼Œæ‰“è¯ï¼šæ€è™«å‰‚A - 2%ï¼Œæ–½è‚¥ï¼šå¤åˆè‚¥ - 50å…¬æ–¤"
        title: æŒ‡ä»¤åº“
        type: template-transform
        variables: []
      height: 54
      id: '1721275010214'
      position:
        x: 2266.892190129982
        y: -237.66275274468452
      positionAbsolute:
        x: 2266.892190129982
        y: -237.66275274468452
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0
          mode: chat
          name: gpt-4o
          provider: openai
        prompt_template:
        - id: 03aa504e-1613-4b2d-9041-dd894f2fb1f8
          role: system
          text: ä½ æ˜¯ä¸€ä¸ªå†œä¸šä¸“å®¶ï¼Œå‡†ç¡®ç®€ä»‹çš„å›ç­”é—®é¢˜ã€‚
        - id: 1bca8b22-eadf-47a7-b11f-1cfc0977993d
          role: user
          text: '{{#1721231004955.output#}}'
        selected: false
        title: LLMå›ç­”é€‚å®œç”Ÿé•¿æ¡ä»¶
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: false
      height: 98
      id: '1721656895073'
      position:
        x: 1646.5578520802178
        y: 187.57871894744812
      positionAbsolute:
        x: 1646.5578520802178
        y: 187.57871894744812
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\ndef main(http_response: str) -> str:\n    http_response = http_response.replace('```json','').replace('```','').replace('\\\
          \\n','').replace('\\\\\"','\"').replace('True','true')\n    import json\n\
          \    data = json.loads(http_response)\n    return {\n        # æ³¨æ„åœ¨è¾“å‡ºå˜é‡ä¸­å£°æ˜\n\
          \        'known_info': data['known_info'],\n        'normal': not data['need_action'],\n\
          \        'action': data['action'],\n        'analyse': data['analyse'],\n\
          \    }"
        code_language: python3
        desc: ''
        outputs:
          action:
            children: null
            type: object
          analyse:
            children: null
            type: string
          known_info:
            children: null
            type: string
          normal:
            children: null
            type: number
        selected: false
        title: è§£æLLMè¿”å›çš„json
        type: code
        variables:
        - value_selector:
          - '1721047696945'
          - text
          variable: http_response
      height: 54
      id: '1721659385758'
      position:
        x: 2646.892190129982
        y: -142.75364472225868
      positionAbsolute:
        x: 2646.892190129982
        y: -142.75364472225868
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\ndef main(http_response: str) -> str:\n    http_response = http_response.replace('```json','').replace('```','').replace('\\\
          \\n','').replace('\\\\\"','\"')\n    import json\n    data = json.loads(http_response)\n\
          \    return {\n        # æ³¨æ„åœ¨è¾“å‡ºå˜é‡ä¸­å£°æ˜\n        'conversation': data\n    }"
        code_language: python3
        desc: ''
        outputs:
          conversation:
            children: null
            type: object
        selected: false
        title: è§£æHTTPè¿”å›çš„json
        type: code
        variables:
        - value_selector:
          - '1721232197774'
          - body
          variable: http_response
      height: 54
      id: '17217051422320'
      position:
        x: 2652.59989980016
        y: 151.15312180352566
      positionAbsolute:
        x: 2652.59989980016
        y: 151.15312180352566
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -1787.4295056924007
      y: 122.7843403866847
      zoom: 0.8705505632961247
